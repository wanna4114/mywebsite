<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEURAL FLOW | Active Theory Style</title>
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Inter:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ffcc; --bg: #050505; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: var(--bg); color: #fff; 
            font-family: 'Inter', sans-serif; overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* 渲染层 */
        canvas#webgl {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; z-index: -1;
        }

        /* 内容层 */
        main { position: relative; z-index: 10; }
        section {
            height: 100vh; display: flex; flex-direction: column;
            justify-content: center; align-items: center; padding: 0 10%;
        }

        .title-wrapper { overflow: hidden; }
        h1 {
            font-family: 'Syncopate', sans-serif;
            font-size: clamp(3rem, 15vw, 12rem);
            line-height: 0.9; text-transform: uppercase;
            letter-spacing: -0.05em; text-align: center;
            opacity: 0; transform: translateY(100%);
        }

        .sub {
            font-size: 0.8rem; letter-spacing: 0.6em;
            text-transform: uppercase; color: var(--accent);
            margin-top: 2rem; opacity: 0;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            padding: 3rem; border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 600px; transform: scale(0.9); opacity: 0;
        }

        /* 鼠标 */
        #cursor {
            position: fixed; width: 40px; height: 40px;
            border: 1px solid var(--accent); border-radius: 50%;
            pointer-events: none; z-index: 9999;
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
        }
    </style>
</head>
<body>

    <div id="cursor"></div>
    <canvas id="webgl"></canvas>

    <main>
        <section id="hero">
            <div class="title-wrapper"><h1>Neural</h1></div>
            <div class="title-wrapper"><h1>Flow</h1></div>
            <p class="sub">Advanced Visual Lab</p>
        </section>

        <section id="about">
            <div class="card">
                <h2 style="font-family:'Syncopate'; margin-bottom:1rem;">THE TECH</h2>
                <p style="color:#888; line-height:1.6;">受 Active Theory 启发，我们使用自定义 GLSL 着色器来模拟数字世界的液态生命。每一个像素的位移都经过复杂的噪波算法处理。</p>
            </div>
        </section>

        <section id="footer">
            <h1 style="font-size: 5vw;">Next Gen</h1>
            <p style="margin-top:20px;">READY FOR V6.0</p>
        </section>
    </main>

    <!-- 引用稳定的库 -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.5/dist/ScrollTrigger.min.js"></script>

    <!-- Shader 逻辑 -->
    <script id="vShader" type="x-shader/x-vertex">
        varying vec2 vUv;
        void main() {
            vUv = uv;
            gl_Position = vec4(position, 1.0);
        }
    </script>

    <script id="fShader" type="x-shader/x-fragment">
        precision highp float;
        uniform float uTime;
        uniform vec2 uMouse;
        uniform vec2 uRes;
        varying vec2 vUv;

        // 强力液态噪声
        void main() {
            vec2 uv = vUv;
            float t = uTime * 0.4;
            
            // 基础流动
            vec2 p = uv * 2.0 - 1.0;
            p.x *= uRes.x / uRes.y;
            
            for(float i = 1.0; i < 4.0; i++) {
                p.x += 0.3 / i * sin(i * 3.0 * p.y + t + uMouse.x * 2.0);
                p.y += 0.3 / i * cos(i * 3.0 * p.x + t + uMouse.y * 2.0);
            }
            
            // RGB 色彩叠加
            float r = sin(p.x + p.y + 1.0) * 0.5 + 0.5;
            float g = sin(p.x + p.y + 2.0) * 0.5 + 0.5;
            float b = sin(p.x + p.y + 3.0) * 0.5 + 0.5;
            
            vec3 color = vec3(r * 0.1, g * 0.4, b * 0.8);
            color += 0.05 / length(p); // 增加中心光感
            
            gl_FragColor = vec4(color, 1.0);
        }
    </script>

    <script>
        // 1. WebGL 初始化
        let scene, camera, renderer, material;

        function initWebGL() {
            const canvas = document.getElementById('webgl');
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            scene = new THREE.Scene();
            camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);

            const geometry = new THREE.PlaneGeometry(2, 2);
            material = new THREE.ShaderMaterial({
                uniforms: {
                    uTime: { value: 0 },
                    uMouse: { value: new THREE.Vector2(0, 0) },
                    uRes: { value: new THREE.Vector2(window.innerWidth, window.innerHeight) }
                },
                vertexShader: document.getElementById('vShader').textContent,
                fragmentShader: document.getElementById('fShader').textContent
            });

            const mesh = new THREE.Mesh(geometry, material);
            scene.add(mesh);
        }

        // 2. 交互与动画
        function initInteractions() {
            // 鼠标跟随
            window.addEventListener('mousemove', (e) => {
                const x = (e.clientX / window.innerWidth);
                const y = 1.0 - (e.clientY / window.innerHeight);
                gsap.to(material.uniforms.uMouse.value, { x, y, duration: 1 });
                gsap.to('#cursor', { x: e.clientX, y: e.clientY, duration: 0.1 });
            });

            // GSAP 开场动画
            const tl = gsap.timeline();
            tl.to('h1', { opacity: 1, y: 0, duration: 1.5, stagger: 0.2, ease: "expo.out" })
              .to('.sub', { opacity: 1, duration: 1 }, "-=1");

            // 滚动触发
            gsap.registerPlugin(ScrollTrigger);
            gsap.to('.card', {
                scrollTrigger: {
                    trigger: '.card',
                    start: "top 90%",
                    end: "bottom 20%",
                    scrub: true
                },
                opacity: 1,
                scale: 1
            });
        }

        function animate(time) {
            if(material) material.uniforms.uTime.value = time * 0.001;
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }

        // 启动
        try {
            initWebGL();
            initInteractions();
            requestAnimationFrame(animate);
            console.log("NEURAL FLOW: System Online");
        } catch (e) {
            console.error("WebGL Failed:", e);
            document.body.innerHTML += "<div style='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);color:red;'>WebGL Initialize Failed.</div>";
        }

        window.addEventListener('resize', () => {
            renderer.setSize(window.innerWidth, window.innerHeight);
            material.uniforms.uRes.value.set(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>